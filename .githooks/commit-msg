#!/bin/sh

message_file="$1"
message=$(cat "$message_file")

# Define the regular expression pattern
regex="^((\[(no|skip) ci\] )?(((feat|tests?|lint|refactor|ci|git|special|doc|typo|log|ts|fix|wip|docker|dep)(-fix|-fail)?(, ?)?)+: |Merge (remote-tracking )?branch|Auto-merging).+|\[release:(patch|minor|major)\] .+)"

if ! echo "$message" | grep -qE "$regex"; then
  echo "[POLICY] Your message is not formatted correctly. Respect the regex: '$regex'!"
  exit 1
fi
